window.__require=function t(e,i,s){function n(h,c){if(!i[h]){if(!e[h]){var a=h.split("/");if(a=a[a.length-1],!e[a]){var r="function"==typeof __require&&__require;if(!c&&r)return r(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+h+"'")}h=a}var d=i[h]={exports:{}};e[h][0].call(d.exports,function(t){return n(e[h][1][t]||t)},d,d.exports,t,e,i,s)}return i[h].exports}for(var o="function"==typeof __require&&__require,h=0;h<s.length;h++)n(s[h]);return n}({enemyHit:[function(t,e,i){"use strict";cc._RF.push(e,"3b09cvKzxVG1IsL73oEr+QX","enemyHit"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.enemy=this.node.parent.getComponent("enemy")},onCollisionEnter:function(t,e){"hero"==t.node.group&&1==t.tag&&this.enemy.hit()}}),cc._RF.pop()},{}],enemy:[function(t,e,i){"use strict";cc._RF.push(e,"18d79xHuTpFsIesguVYEoo3","enemy");var s=0,n=1,o=4;cc.Class({extends:cc.Component,properties:{isHit:!1,hp:5,moveLeft:!1,moveRight:!1},onLoad:function(){var t=this;this.ani=this.node.getChildByName("body").getComponent(cc.Animation),this.anime="eIdle",this.lv=this.node.getComponent(cc.RigidBody).linearVelocity,this.rb=this.node.getComponent(cc.RigidBody),this._speed=80,this.sp=cc.v2(0,0),this.tt=0,this.enemyState=s,this.playerNode=cc.find("Canvas/bg/hero"),this.ani.on("finished",function(e,i){"hit"==i.name?(t.hp--,t.isHit=!1,t.enemyState=s,console.log(t.hp),0==t.hp&&t.node.destroy()):"eAttack"==i.name&&(t.setAni("eIdle"),t.enemyState=s)})},hit:function(){this.isHit||(this.enemyState=o,this.isHit=!0,this.lv=this.rb.linearVelocity,this.lv.x=0,this.rb.linearVelocity=this.lv,this.setAni("hit"))},enemyAct:function(t){var e=this.playerNode.position,i=this.node.position,o=cc.Vec2.distance(e,i);if(o<=25)console.log("att"),this.moveLeft=!1,this.moveRight=!1,this.attack(),this.enemyState=n;else if(o<=150){e.sub(i).x<0?(this.moveLeft=!0,this.moveRight=!1):(this.moveLeft=!1,this.moveRight=!0),console.log("zui"),this.enemyState=s}else console.log("stand"),this.moveLeft=!1,this.moveRight=!1,this.enemyState=s},attack:function(){this.setAni("eAttack"),this.lv=this.rb.linearVelocity,this.lv.x=0,this.rb.linearVelocity=this.lv},Move:function(){var t=Math.abs(this.node.getChildByName("body").scaleX);this.moveLeft?(this.sp.x=-1,this.node.scaleX=-t,this.setAni("walk")):this.moveRight?(this.sp.x=1,this.node.scaleX=t,this.setAni("walk")):(this.setAni("eIdle"),this.sp.x=0),this.sp.x?this.lv.x=this.sp.x*this._speed:this.lv.x=0,this.node.getComponent(cc.RigidBody).linearVelocity=this.lv},setAni:function(t){this.anime!=t&&(this.anime=t,this.ani.play(t))},update:function(t){this.tt+=t,this.tt>=.3&&this.enemyState==s&&(this.enemyAct(t),this.tt=0),this.enemyState==n?this.attack():this.enemyState==s&&this.Move()}}),cc._RF.pop()},{}],game:[function(t,e,i){"use strict";cc._RF.push(e,"bd880u30ANCELt3GNgoMu2l","game"),cc.Class({extends:cc.Component,properties:{mapNode:cc.Node},onLoad:function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,this.initMapNode(this.mapNode)},initMapNode:function(t){for(var e=t.getComponent(cc.TiledMap),i=e.getTileSize(),s=e.getLayer("wall"),n=s.getLayerSize(),o=0;o<n.width;o++)for(var h=0;h<n.height;h++){var c=s.getTiledTileAt(o,h,!0);if(0!=c.gid){c.node.group="wall",c.node.addComponent(cc.RigidBody).type=cc.RigidBodyType.Static;var a=c.node.addComponent(cc.PhysicsBoxCollider);a.offset=cc.v2(i.width/2,i.height/2),a.size=i,a.apply()}}},start:function(){}}),cc._RF.pop()},{}],hero:[function(t,e,i){"use strict";cc._RF.push(e,"612bcAqsL9PPI+IR+2JQoFL","hero");var s={},n=0,o=1;cc.Class({extends:cc.Component,properties:{},onLoad:function(){this._speed=200,this.sp=cc.v2(0,0),this.heroState=n,this.anime="idle",this.heroAni=this.node.getChildByName("body").getComponent(cc.Animation),this.comb=0,this.lv=this.node.getComponent(cc.RigidBody).linearVelocity,this.heroAni.on("finished",this.onAnimeFinished,this),cc.systemEvent.on("keydown",this.onKeyDown,this),cc.systemEvent.on("keyup",this.onKeyUp,this)},onDestroy:function(){cc.systemEvent.off("keydown",this.onKeyDown,this),cc.systemEvent.off("keyup",this.onKeyUp,this),this.heroAni.off("finished",this.onAnimeFinished,this)},setAni:function(t){this.anime!=t&&(this.anime=t,this.heroAni.play(t))},onAnimeFinished:function(t,e){var i=this;"attack0"!=e.name&&"attack1"!=e.name&&"attack2"!=e.name||(this.heroState=n,this.comb=(this.comb+1)%3,setTimeout(function(){i.heroState!=o&&(i.comb=0)},500))},onKeyDown:function(t){s[t.keyCode]=1},onKeyUp:function(t){s[t.keyCode]=0},attack:function(){s[cc.macro.KEY.j]&&(0==this.comb?this.setAni("attack0"):1==this.comb?this.setAni("attack1"):2==this.comb&&this.setAni("attack2"),this.sp.x=0)},move:function(){var t=Math.abs(this.node.getChildByName("body").scaleX);s[cc.macro.KEY.a]||s[cc.macro.KEY.left]?(this.sp.x=-1,this.node.scaleX=-t,this.setAni("run")):s[cc.macro.KEY.d]||s[cc.macro.KEY.right]?(this.sp.x=1,this.node.scaleX=t,this.setAni("run")):(this.sp.x=0,this.setAni("idle")),this.sp.x?this.lv.x=this.sp.x*this._speed:this.lv.x=0,this.node.getComponent(cc.RigidBody).linearVelocity=this.lv},update:function(t){switch(this.heroState){case n:s[cc.macro.KEY.j]&&(this.heroState=o)}this.heroState==o?this.attack():this.heroState==n&&this.move()}}),cc._RF.pop()},{}]},{},["enemy","enemyHit","game","hero"]);